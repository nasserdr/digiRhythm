<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Computing the DFC/HP and manipulating the functions returned objects • digiRhythm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing the DFC/HP and manipulating the functions returned objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">digiRhythm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Actgram_diurnality_avg_activity.html">Visualizing actograms, average activity and diurnality index</a></li>
    <li><a class="dropdown-item" href="../articles/DFC_and_HP_and_changing_plots.html">Computing the DFC/HP and manipulating the functions returned objects</a></li>
    <li><a class="dropdown-item" href="../articles/Loading_and_preprocessing_data_in_DigiRhythm.html">Loading and preprocessing data in DigiRhythm</a></li>
    <li><a class="dropdown-item" href="../articles/Visualisation.html">Further options of visualization in DigiRhythm</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computing the DFC/HP and manipulating the functions returned objects</h1>
                        <h4 data-toc-skip class="author">Hassan-Roland
Nasser and Marie Schneider</h4>
            
            <h4 data-toc-skip class="date">2025-02-27</h4>
      

      <div class="d-none name"><code>DFC_and_HP_and_changing_plots.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nasserdr.github.io/digiRhythm/">digiRhythm</a></span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">digiRhythm</span><span class="fu">::</span><span class="va"><a href="../reference/df691b_1.html">df691b_1</a></span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resample_dgm.html">resample_dgm</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_activity_outliers.html">remove_activity_outliers</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">activity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">activity</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Steps"</span></span></code></pre></div>
<div class="section level2">
<h2 id="degree-of-functional-coupling-dfc-and-harmonic-power-hp">Degree of Functional Coupling (DFC) and Harmonic Power (HP)<a class="anchor" aria-label="anchor" href="#degree-of-functional-coupling-dfc-and-harmonic-power-hp"></a>
</h2>
<p>The degree of functional coupling and the harmonic power could be
computed using the dfc function as shown below.</p>
<p>The DFC algorithm is a bit complicated. It’s, therefore, needed that
we clarify few points about some computing considerations and also about
the arguments of the function itself:</p>
<ul>
<li>The recommended sampling period is between 15 and 30 min.</li>
<li>The DFC and HP are computed each X days. We call X the rolling
window. For example, if the rolling window is 7 days, the first DFC/HP
value is computed for the subset between day 1 and day 7, and the second
DFC/HP value is computed for the subset between day 2 and day 8, and so
on. If the data contains 8 days of data, then we will only have two DFC
and HP values. The recommended rolling window is 7 days, however the
user can choose a rolling window not less than two days and not more
that the number of days in the dataset -1.</li>
<li>As the computation of DFC/HP are mainly based on the power of the
24-hours harmonics (24/1 is the first harmonic, 24/2 is the second
harmonic, 24/3 is the third harmonic, and so on), the user can choose up
till which harmonic to consider. The default value is 12. It’s important
to note that the lowest harmonic period should be twice bigger than the
sampling period. For example, if your data is sampled at 15 minutes,
then the lowest harmonic period should be 30 minutes. This is because
the Nyquist frequency is half the sampling frequency. Consequently, the
harmonic cutoff parameter should be set to not more than 48 (because 24
hours * 60 min / 48 = 30 min = 2 * 15 min of sampling period).</li>
</ul>
<p>The user does not need to worry about looping over days or extracting
the Lomb Scargle periodogram for every X (rolling window) days and then
compile the results to obtain the degree of functional coupling. This is
done in loop inside the dfc function. However, there is also a function
call lomb_scargle_periodogram where the user can investigate the
activity a little bit deeper. We preview the lomb_scargle_periodogram
function and its output, then we go to the dfc function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">672</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"datetime"</span>, <span class="va">activity</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">my_lsp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lomb_scargle_periodogram.html">lomb_scargle_periodogram</a></span><span class="op">(</span><span class="va">df</span>, alpha <span class="op">=</span> <span class="fl">0.01</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>8 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre></div>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/lsp-1.png" width="672"></p>
<p>In the above plot, we see plenty of information. First, we have the
whole periodogram for the dataframe df visualized. Second, we can
distinguish between harmonic and non harmonic frequencies. Harmonic
frequencies are plotted in blue and tagged with the time period they
correspond to. For instance, we can check the power of the 24h cycles,
12h cycles, 6h cycles and so on. Third, we have a dotted horizontal line
that makes it easy to visually check which frequencies are considered to
originated from noise rather than from a actual signal. Frequency bars
that make it above this line are considered to be originated from a real
activity. The probability of this event is calculated using the method
of Baluev (2008). The plot also shows, as title, the activity time span
used for the computation. Warning: At the moment, function only computes
the LSP the first 7 days of the data. A loop, to calculate LSP for the
whole data, will be included in a later version. However, at the moment
user can see the LSP-diagrams of the whole data, if running the dfc
function. Before the complete DFC and HP diagram, each LSP diagram of
the sliding 7-day periods were computed.</p>
<p>Now, to the DFC. The below plot shows the DFC and HP in the same
graph. Both variables are percentages.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_dfc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dfc.html">dfc</a></span><span class="op">(</span><span class="va">data</span>, <span class="co"># The dataset</span></span>
<span>  activity <span class="op">=</span> <span class="va">activity</span>, <span class="co"># the name of the activity column</span></span>
<span>  sampling <span class="op">=</span> <span class="fl">15</span>, <span class="co"># the sampling frequency of my dataset is 15</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>, <span class="fl">5</span>, <span class="co"># significance level</span></span>
<span>  harm_cutoff <span class="op">=</span> <span class="fl">12</span>, <span class="co"># up till the harmonic 24/12 which is two hours</span></span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;              datetime Motion.Index Steps</span></span>
<span><span class="co">#&gt; 1 2020-08-25 00:00:00           20     8</span></span>
<span><span class="co">#&gt; 2 2020-08-25 00:15:00           52    46</span></span>
<span><span class="co">#&gt; 3 2020-08-25 00:30:00           61    39</span></span>
<span><span class="co">#&gt; 4 2020-08-25 00:45:00           29    18</span></span>
<span><span class="co">#&gt; 5 2020-08-25 01:00:00           83    26</span></span>
<span><span class="co">#&gt; 6 2020-08-25 01:15:00           50    23</span></span>
<span><span class="co">#&gt; [1] 43</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>4 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre></div>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-2.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-3.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-4.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-5.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-6.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-7.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-8.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-9.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-10.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-11.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-12.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-13.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-14.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-15.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-16.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-17.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-18.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-19.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-20.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-21.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-22.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-23.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-24.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-25.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-26.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-27.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-28.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-29.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-30.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-31.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-32.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-33.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-34.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-35.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-36.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-37.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-38.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-39.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-40.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-41.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-42.png" width="672"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BB00;">v Correct time format: </span>First column has a POSIXct Format </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Number of days good for DFC: </span>5 days &gt;= 2 days </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">v Correct numeric format - Column 2 ==&gt; Steps</span> </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">The data is digiRhythm friendly</span></span></span></code></pre>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-43.png" width="672"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setting plot to TRUE will visualize all the LSP plots (like the one above)</span></span>
<span><span class="co"># during each sliding window. Rather used for deeper investigation and</span></span>
<span><span class="co"># debugging.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_dfc</span><span class="op">)</span></span></code></pre></div>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/dfc_hp-44.png" width="672">
# Accessing output data and changing the plots using DigiRhythm</p>
<p>The DFC function returns a object of type ggplot:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">my_dfc</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "gg"     "ggplot"</span></span></code></pre></div>
<p>As shown, the class is gg or ggplot. This allows the user to: -
Access the data of DFC or HP directly from the returned object. - Add
aesthetics layer to the plot as needed.</p>
<p>To access the data, user has to use the <em>data</em> component of
the DFC object. We illustrate this in the below code:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">my_dfc</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;         from         to       dfc        hp</span></span>
<span><span class="co">#&gt; 1 2020-08-24 2020-08-28 0.4398348 0.4398348</span></span>
<span><span class="co">#&gt; 2 2020-08-25 2020-08-29 0.4287425 0.4287425</span></span>
<span><span class="co">#&gt; 3 2020-08-26 2020-08-30 0.3283561 0.3283561</span></span>
<span><span class="co">#&gt; 4 2020-08-27 2020-08-31 0.2470351 0.2470351</span></span>
<span><span class="co">#&gt; 5 2020-08-28 2020-09-01 0.2422273 0.2422273</span></span>
<span><span class="co">#&gt; 6 2020-08-29 2020-09-02 0.2583468 0.2583468</span></span></code></pre></div>
<p>As shown, we can access a dataframe where the first comlumn is the
date and the second two columns are the DFC and HP respectively. This
will allow the users to be able to use the returned data in further
studies such as modelling.</p>
<p>Users can also change the aesthetics of the plot directly if they
wish. This is possible by adding a ggplot layer to the returned DFC
object. For instance, this is the original plot returned by the DFC:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_dfc</span><span class="op">)</span></span></code></pre></div>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/og_plot-1.png" width="672">
As an illustrative example, in the below code we add a new aesthetic
layer to the ggplot object. This layer does nothing but increasing the
width of the x-axis. Users can add any other aesthetic layer as they
wish; the immagination is the only limit.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">new_plot</span> <span class="op">&lt;-</span> <span class="va">my_dfc</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Times"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">new_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="DFC_and_HP_and_changing_plots_files/figure-html/change_aes-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hassan-Roland Nasser, Marie Schneider, Joanna Stachowicz, Christina Umstaetter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
